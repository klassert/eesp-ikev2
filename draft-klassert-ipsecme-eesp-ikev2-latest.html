<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IKEv2 negotiation for Enhanced Encapsulating Security Payload</title>
<meta content="Steffen Klassert" name="author">
<meta content="Antony Antony" name="author">
<meta content="Tobias Brunner" name="author">
<meta content="
       This document species how to negotiate Enhanced Encapsulating
Security Payload (EESP) Security Associations using IKEv2. EESP
which builds on the existing IP Encapsulating Security Payload (ESP)
protocol. 
       This documents also updates RFC7296 by adding new Security Protocol
type EESP. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="EESP" name="keyword">
<meta content="IKEv2" name="keyword">
<meta content="draft-klassert-ipsecme-eesp-ikev2-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.3
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.1.2
    wcwidth 0.2.13
-->
<link href="draft/draft-klassert-ipsecme-eesp-ikev2-00.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EESP IKEv2 negotiation</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Klassert, et al.</td>
<td class="center">Expires 17 July 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">IPSECME Working Group</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01-13" class="published">13 January 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-07-17">17 July 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Klassert</div>
<div class="org">secunet</div>
</div>
<div class="author">
      <div class="author-name">A. Antony</div>
<div class="org">secunet</div>
</div>
<div class="author">
      <div class="author-name">T. Brunner</div>
<div class="org">codelabs GmbH</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IKEv2 negotiation for Enhanced Encapsulating Security Payload</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document species how to negotiate Enhanced Encapsulating
Security Payload (EESP) Security Associations using IKEv2. EESP
which builds on the existing IP Encapsulating Security Payload (ESP)
protocol.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This documents also updates RFC7296 by adding new Security Protocol
type EESP.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 17 July 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-eesp-sa-ikev2-negotiation" class="internal xref">EESP SA IKEv2 Negotiation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-negotiating-an-eesp-sa-usin" class="internal xref">Negotiating an EESP SA using IKE_AUTH or CREATE_CHILD_SA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-rekeying-an-eesp-sa-with-th" class="internal xref">Rekeying an EESP SA with the CREATE_CHILD_SA Exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-deleting-eesp-sa-with-infor" class="internal xref">Deleting EESP SA with INFORMATIONAL Exchange</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-eesp-sa-transforms" class="internal xref">EESP SA Transforms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-replay-protection-service" class="internal xref">Replay Protection Service</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-explicit-initialization-vec" class="internal xref">Explicit Initialization Vector</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-implicit-initialization-vec" class="internal xref">Implicit Initialization Vectors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-eesp-version" class="internal xref">EESP Version</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-eesp-flow-identifier" class="internal xref">EESP Flow Identifier</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-sub-sas" class="internal xref">Sub SAs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-udp-encapsulation-of-sub-sa" class="internal xref">UDP Encapsulation of Sub SA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-key-derivation-for-sub-sa" class="internal xref">Key derivation for Sub SA</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-iterative-key-derivation" class="internal xref">Iterative key derivation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-hierarchical-key-derivation" class="internal xref">Hierarchical key derivation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-rekey-key-derivation" class="internal xref">Rekey Key Derivation.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-multiple-sender-group-sa-da" class="internal xref">Multiple Sender Group SA Data SA Key Derivation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-session-id" class="internal xref">Session ID</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-udp-encapsulation-for-eesp" class="internal xref">UDP Encapsulation for EESP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-responder-receiving-port" class="internal xref">Responder Receiving Port</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-eesp-crypt-offset-option" class="internal xref">EESP Crypt Offset Option</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-changes-in-the-existing-ike" class="internal xref">Changes in the Existing IKEv2 Registries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.1">
                    <p id="section-toc.1-1.8.2.1.2.1.1"><a href="#section-8.1.1" class="auto internal xref">8.1.1</a>.  <a href="#name-ikev2-security-protocol-ide" class="internal xref">IKEv2 Security Protocol Identifiers registry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.2">
                    <p id="section-toc.1-1.8.2.1.2.2.1"><a href="#section-8.1.2" class="auto internal xref">8.1.2</a>.  <a href="#name-ikev2-transform-type-values" class="internal xref">IKEv2 Transform Type Values registry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.3">
                    <p id="section-toc.1-1.8.2.1.2.3.1"><a href="#section-8.1.3" class="auto internal xref">8.1.3</a>.  <a href="#name-ikev2-notify-message-status" class="internal xref">IKEv2 Notify Message Status Types registry.</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.4">
                    <p id="section-toc.1-1.8.2.1.2.4.1"><a href="#section-8.1.4" class="auto internal xref">8.1.4</a>.  <a href="#name-extending-esp-with-eesp" class="internal xref">Extending ESP with EESP</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1.2.5">
                    <p id="section-toc.1-1.8.2.1.2.5.1"><a href="#section-8.1.5" class="auto internal xref">8.1.5</a>.  <a href="#name-notify-message-error-types" class="internal xref">Notify Message Error Types</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-new-registries" class="internal xref">New Registries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.1">
                    <p id="section-toc.1-1.8.2.2.2.1.1"><a href="#section-8.2.1" class="auto internal xref">8.2.1</a>.  <a href="#name-eesp-session-id-registry" class="internal xref">EESP Session ID registry</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2.2.2">
                    <p id="section-toc.1-1.8.2.2.2.2.1"><a href="#section-8.2.2" class="auto internal xref">8.2.2</a>.  <a href="#name-eesp-flow-id-registry" class="internal xref">EESP Flow ID registry</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-additional-stuff" class="internal xref">Additional Stuff</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Enhanced Encapsulating Security Payload (EESP), specified in
<span>[<a href="#I-D.klassert-ipsecme-eesp" class="cite xref">I-D.klassert-ipsecme-eesp</a>]</span>, introduces enhancements to the
Encapsulating Security Payload (ESP) defined in [RFC4303]. These
improvements address evolving requirements in modern IPsec
deployments. EESP offers increased flexibility for hardware
offloads at the packet level. It supports carrying inner packet flow
identifiers for the use with ECMP, RSS hardware, and IPsec peers
prior to decryption. EESP also enables the establishment of Sub Child
SAs with independent sequence number spaces. Additionally, it
supports the use of 64-bit sequence numbers in each packet or the
omission of sequence numbers when the Replay Protection service is
disabled. EESP packets carry a version number, enabling easier
support for future extensions.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document specifies the negotiation of EESP Security
Associations (SAs) within the Internet Key Exchange Protocol
Version 2 (IKEv2) protocol [RFC7296]. It details the creation,
rekeying, and deletion of EESP SAs, as well as the negotiation of
EESP specific transform properties and properties.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The extensions defined here enable EESP SAs to coexist with ESP SAs
in stateful decryption configurations, sharing a common SPI namespace
while introducing new capabilities to enhance IPsec’s performance
and versatility in modern use cases.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document does not obsolete or update any existing RFCs. While
stateless implementations of EESP are referenced, their negotiation,
which is similar to <span>[<a href="#PSP" class="cite xref">PSP</a>]</span>, is outside the scope of this document.<a href="#section-1-4" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">It is assumed that readers are familiar with the IKEv2 negotiation
<span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>, IPsec architecture <span>[<a href="#RFC4301" class="cite xref">RFC4301</a>]</span> and ESP <span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span>.
This document uses a notation and conventions from IKEv2 [RFC7296]
to negotiate EESP.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">This document uses the following terms defined in IKEv2 <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>:
Child SA, CREATE_CHILD_SA exchange, IKE_AUTH exchange,
USE_TRANSPORT_MODE<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">This document uses the following terms defined in <span>[<a href="#PSP" class="cite xref">PSP</a>]</span>: PSP (a
recursive acronym for PSP Security Protocol), Network Identifier
(VNI), Crypt Offset.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">This document uses the following terms defined in <span>[<a href="#RFC2992" class="cite xref">RFC2992</a>]</span>:
Equal-cost multi-path (ECMP)<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">This document uses the following terms defined in <span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span>:
Encapsulating Security Payload (ESP).<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">This document uses the following terms defined in
<span>[<a href="#I-D.mrossberg-ipsecme-multiple-sequence-counters" class="cite xref">I-D.mrossberg-ipsecme-multiple-sequence-counters</a>]</span>: Sub-Child SA.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">This document uses the following terms defined in
<span>[<a href="#I-D.ietf-ipsecme-ikev2-rename-esn" class="cite xref">I-D.ietf-ipsecme-ikev2-rename-esn</a>]</span> : Replay Protection.<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<p id="section-1.2-8">This document uses the following terms defined in
<span>[<a href="#I-D.ietf-ipsecme-g-ikev2" class="cite xref">I-D.ietf-ipsecme-g-ikev2</a>]</span>: Sender-ID.<a href="#section-1.2-8" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-2">
      <h2 id="name-eesp-sa-ikev2-negotiation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-eesp-sa-ikev2-negotiation" class="section-name selfRef">EESP SA IKEv2 Negotiation</a>
      </h2>
<p id="section-2-1">To negotiate of EESP Security Associations (SAs), as specified
in <span>[<a href="#I-D.klassert-ipsecme-eesp" class="cite xref">I-D.klassert-ipsecme-eesp</a>]</span>. Propose '<code>Protocol ID</code>' EESP input
SA Payload, Proposal payload.
These extensions provide the ability to establish EESP SAs using
the IKE_AUTH or the CREATE_CHILD_SA exchanges. The initiator includes
EESP-specific transforms and attributes in the proposal, allowing
the responder to evaluate and establish the SA if supported.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">IKEv2 Notify Message Status Type USE_WESP_MODE, <span>[<a href="#RFC5840" class="cite xref">RFC5840</a>]</span>, is not
supported when negotiating EESP SA. As the WESP functionality
is part of EESP protocol. If this notification is received it
MUST be discarded.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The ESP_TFC_PADDING_NOT_SUPPORTED, <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>, notification is not
supported in EESP, instead use IP-TFS, USE_AGGFRAG, <span>[<a href="#RFC9347" class="cite xref">RFC9347</a>]</span>.
If this notification is received it MUST be discarded.<a href="#section-2-3" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-negotiating-an-eesp-sa-usin">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-negotiating-an-eesp-sa-usin" class="section-name selfRef">Negotiating an EESP SA using IKE_AUTH or CREATE_CHILD_SA</a>
        </h3>
<p id="section-2.1-1">To negotiate an EESP Child SA, use the IKEv2 IKE_AUTH or
CREATE_CHILD_SA new SA exchange. The SA Payload, Proposal
MUST have Security Protocol Identifier, Proto Id = EESP
which is specified in <span>[<a href="#I-D.klassert-ipsecme-eesp" class="cite xref">I-D.klassert-ipsecme-eesp</a>]</span>,
as specified in this document, and uses the
EESP Transform attributes defined in <a href="#sec-eesp-sa-transforms" class="auto internal xref">Section 3</a>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-rekeying-an-eesp-sa-with-th">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-rekeying-an-eesp-sa-with-th" class="section-name selfRef">Rekeying an EESP SA with the CREATE_CHILD_SA Exchange</a>
        </h3>
<p id="section-2.2-1">Rekeying an EESP SA follows the same procedure as rekeying an ESP SA,
as specified in Sections 1.3.3 and 2.8 of <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>. During the
rekeying process, the <a href="#sec-eesp-sa-transforms" class="auto internal xref">Section 3</a> MUST remain identical to
those negotiated when the SA was initially established.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.3">
        <h3 id="name-deleting-eesp-sa-with-infor">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-deleting-eesp-sa-with-infor" class="section-name selfRef">Deleting EESP SA with INFORMATIONAL Exchange</a>
        </h3>
<p id="section-2.3-1">EESP SA always exist in pairs. Deleting EESP SA follows the same
procedure as deleting Child SA using IKEv2 INFORMATIONAL exchange as
specified in Section 1.4.1 <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span><a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="sec-eesp-sa-transforms">
<section id="section-3">
      <h2 id="name-eesp-sa-transforms">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-eesp-sa-transforms" class="section-name selfRef">EESP SA Transforms</a>
      </h2>
<p id="section-3-1">EESP introduces several transform properties that are negotiated
during the establishment of an EESP SA. These properties MUST be
identical for the duration of the SA. When the SA is rekeyed,
the new SA MUST inherit all EESP transform properties negotiated for
the original EESP SA.<a href="#section-3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Type</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
            <th class="text-left" rowspan="1" colspan="1">Used In</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD4</td>
            <td class="text-left" rowspan="1" colspan="1">EESP Version(EESPV)</td>
            <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
            <td class="text-left" rowspan="1" colspan="1">[this document]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD5</td>
            <td class="text-left" rowspan="1" colspan="1">EESP Sub SA(EESPSUBSA)</td>
            <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
            <td class="text-left" rowspan="1" colspan="1">[this document]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD6</td>
            <td class="text-left" rowspan="1" colspan="1">EESP Session ID(EESPSID)</td>
            <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
            <td class="text-left" rowspan="1" colspan="1">[this document]</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TBD7</td>
            <td class="text-left" rowspan="1" colspan="1">EESP Flow ID(EESPFID)</td>
            <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
            <td class="text-left" rowspan="1" colspan="1">[this document]</td>
          </tr>
        </tbody>
      </table>
<span id="name-eesp-sa-proposal"></span><div id="eesp-sa-proposal">
<figure id="figure-1">
        <div class="sourcecode" id="section-3-3.1">
<pre>
SA Payload
   |
   +--- Proposal #1 ( Proto ID = EESP(TBD1), SPI size = 4,
   |     |            8 transforms,      SPI = 0x052357bb )
   |     |
   |     +-- Transform ENCR ( Name = ENCR_AES_CBC )
   |     |     +-- Attribute ( Key Length = 128 )
   |     +-- Transform INTEG ( Name = AUTH_HMAC_SHA1_96 )
   |     +-- Transform INTEG ( Name = AUTH_AES_XCBC_96 )
   |     +-- Transform RP   ( Name = ESN(1) )
   |     +-- Transform EESPV ( Name = V1 )
   |     +-- Transform EESPSUBSA ( Name =  )
   |     +-- Transform EESPSSID ( Name =  )
   |     +-- Transform EESPFID ( Name =  )
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-eesp-sa-proposal" class="selfRef">EESP SA proposal</a>
        </figcaption></figure>
</div>
<section id="section-3.1">
        <h3 id="name-replay-protection-service">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-replay-protection-service" class="section-name selfRef">Replay Protection Service</a>
        </h3>
<p id="section-3.1-1">EESP provides an optional Replay service using a
64 bit Sequence Number, carried in the packet.
To enable Replay service the initiator SHOULD
propose replay protection(RP) Transforms RP = (1, Name 64 bit ESN)
in Substructure of the Proposal Substructure inside the Security
Association (SA) payload in the IKEv2 Exchange. When the responder
select 64 bit ESN a receiver MUST enable Reply Protection.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">When the Transform Type <span>[<a href="#IKEv2-RP" class="cite xref">IKEv2-RP</a>]</span> is not present in initiator's
Child SA proposal during negotiation of an EESP Child SA, the
Sequence Number field MUST NOT be transmitted in the EESP packet.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">When RP is not negotiated, i.e., when the 64 bit sequence number is
not carried in the EESP packet, an EESP receiver should not act on
address or port changes. It should not initiate a dynamic address
update without the use of IKEv2 Mobility <span>[<a href="#RFC4555" class="cite xref">RFC4555</a>]</span>. Since the Replay
Protection service is disabled, an attacker could replay packets with
a different source address. Otherwise, an attacker could disrupt the
connection by capturing and replaying a single packet with different
source address or port number.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-explicit-initialization-vec">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-explicit-initialization-vec" class="section-name selfRef">Explicit Initialization Vector</a>
        </h3>
<p id="section-3.2-1">If the algorithm used to encrypt the payload requires cryptographic
synchronization data, e.g., an Initialization Vector (IV), then this
may be carried explicitly in every EESP packet.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-implicit-initialization-vec">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-implicit-initialization-vec" class="section-name selfRef">Implicit Initialization Vectors</a>
        </h3>
<p id="section-3.3-1">When using the Implicit Initialization Vector (IIV) encryption
algorithm <span>[<a href="#RFC8750" class="cite xref">RFC8750</a>]</span>, the IV MUST be omitted. To negotiate this,
IIV transforms specified in <span>[<a href="#IKEv2-Enc" class="cite xref">IKEv2-Enc</a>]</span> MUST be used. Additionally,
<span>[<a href="#IKEv2-RP" class="cite xref">IKEv2-RP</a>]</span> MUST be negotiated to carry a 64-bit ESN in the EESP
packet if the peers<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4">
        <h3 id="name-eesp-version">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-eesp-version" class="section-name selfRef">EESP Version</a>
        </h3>
<p id="section-3.4-1">Each SA need an EESP Base Header version which is specified
<span>[<a href="#I-D.klassert-ipsecme-eesp" class="cite xref">I-D.klassert-ipsecme-eesp</a>]</span>. An Initiator may propose multipe
EESPV and the responder MUST choose one proposal.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.5">
        <h3 id="name-eesp-flow-identifier">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-eesp-flow-identifier" class="section-name selfRef">EESP Flow Identifier</a>
        </h3>
<p id="section-3.5-1">EESP Flow Identifier (EESPFID) Options are used to carry
characteristic information of the inner flow and SHOULD NOT change on
per packet basis inside any inner flow to avoid packet reordering.
The Flow Identifier SHOULD be negotiated when creating EESP SA.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-4">
      <h2 id="name-sub-sas">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-sub-sas" class="section-name selfRef">Sub SAs</a>
      </h2>
<p id="section-4-1">A Sub SA is a unidirectional Security Association derived from an
existing EESP Child SA pair. It inherits all properties except
keys, sequence number space, and IV space. These three are unique for
each Sub SA. This allows finer granularity for managing
one-directional traffic flows. Sub SAs avoid the overhead associated
with bidirectional Child SAs for identical traffic
selections<span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>, <span>[<a href="#RFC9611" class="cite xref">RFC9611</a>]</span>. They enable more efficient
resource utilization and improved performance, particularly in
scenarios requiring high flexibility. Each Sub SA is uniquely
identified by a Sub SA ID, which is used to derive a unique key. The
Sub SA ID is carried in each EESP packet, either in the Session ID
field or the Flow ID field, as negotiated during the establishment of
the EESP Child SA.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Advantages of Sub SAs compared to Child SAs with different keys:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
          <p id="section-4-3.1.1">Possibility for unidirectional SAs. Compared to <span>[<a href="#RFC9611" class="cite xref">RFC9611</a>]</span>, when a
per-resource SA is established, it is bidirectional. However, both
directions of the SA MAY not always be in use. Using CREATE_CHILD_SA
does not allow unidirectional SAs.<a href="#section-4-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.2">
          <p id="section-4-3.2.1">No extra setup time, i.e., zero round-trip time to set up
additional Sub SAs. This would be more efficient than using large
IKE window size specified in <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> to manage multiple SAs.<a href="#section-4-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-3.3">
          <p id="section-4-3.3.1">Sub SAs are more efficient to create, rekey, and delete. Their<a href="#section-4-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-4">lifecycle management is simpler compared to traditional Child SAs.<a href="#section-4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-5.1">
          <p id="section-4-5.1.1">When using hierarchical key derivation, especially when using
hardware key derivation, Sub SA keys can be derived on-the-fly
per packet. This reduces "Data-plane performance degradation due to
the use of a larger number of keys" as noted in
<span>[<a href="#I-D.ponchon-ipsecme-anti-replay-subspaces" class="cite xref">I-D.ponchon-ipsecme-anti-replay-subspaces</a>]</span>.<a href="#section-4-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-4-6">To negotiate Sub SA SUB_SA_ID in Session ID Transform. Or in a Flow
IDs Transform. TBD: expand Sub SA with Flow ID  negotiation<a href="#section-4-6" class="pilcrow">¶</a></p>
<section id="section-4.1">
        <h3 id="name-udp-encapsulation-of-sub-sa">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-udp-encapsulation-of-sub-sa" class="section-name selfRef">UDP Encapsulation of Sub SA</a>
        </h3>
<p id="section-4.1-1">An EESP SA primarily uses UDP encapsulation to facilitate NAT
traversal.  However, an additional use case for UDP encapsulation is
to introduce source port entropy, which supports ECMP or/and
RSS (Receive Side Scaling) mechanisms. In such scenarios, the
initiator MAY use a distinct, ephemeral source port for Sub SA IDs
greater than zero. Both peers MAY independently select different
source ports for the same Sub SA ID.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">It is important to note that all IKE messages MUST NOT utilize these
ephemeral source ports. Instead, IKE traffic should be confined to
the source and destination ports to ensure proper protocol operation
and maintain compatibility with existing implementations.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">When using ephemeral source ports, the receiver can only set the
source port upon arrival of an EESP packet with that Sub SA ID. If
the receiver
is pre-populating a Sub SA, it may have to install it with a source
port set to zero and, upon arrival of a packet, update the source
port using a mapping change.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Additionally, when multiple Sub SAs exist, the receiver SHOULD
maintain a mapping table to track the source port associated with
each Sub SA ID. This ensures that traffic is correctly routed and
prevents ambiguity in handling packets associated with different Sub SAs.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2">
        <h3 id="name-key-derivation-for-sub-sa">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-key-derivation-for-sub-sa" class="section-name selfRef">Key derivation for Sub SA</a>
        </h3>
<p id="section-4.2-1">When the EESP SA is negotiated with a Sub SA Keys (SUB_SA_ID), each
Sub SA need to derive its own unique keys. This allows each Sub SA
its own independent Sequence Number space, and independent IV space.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Initially we are proposing three Key Derivation Functions(KDF) for
Sub SAs. Based on community feedback, further research and advise from
cryptographers one method will be chosen.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The requirements:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-4.1">
            <p id="section-4.2-4.1.1">Independent keys for each Sub SA<a href="#section-4.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.2">
            <p id="section-4.2-4.2.1">Ability to derive Sub SA keys on the fly with least amount of memory usage<a href="#section-4.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.3">
            <p id="section-4.2-4.3.1">Minimal memory requirements<a href="#section-4.2-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.2-4.4">
            <p id="section-4.2-4.4.1">Keyderviation support multiple SAs, such as EESP, AH<a href="#section-4.2-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<section id="section-4.2.1">
          <h4 id="name-iterative-key-derivation">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-iterative-key-derivation" class="section-name selfRef">Iterative key derivation</a>
          </h4>
<p id="section-4.2.1-1">To iteratively derive keys create a large keymt. e.g. for the nth<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">KEYMAT = prf+(SK_d, Ni | Nr)
When there is no additional Key Exchange.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">KEYMAT = prf+(SK_d, g^ir (new) | Ni | Nr)
When there is additional Key Exchange Paload, a.k.a. PFS.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">Where SK_d is derived from IKE negotiation, as specified in Section
2.14 of <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span><a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">Where g^ir (new) is the shared secret from the ephemeral Key Exchange
of this CREATE_CHILD_SA exchange (represented as an
octet string in big endian order padded with zeros in the high-order
bits if necessary to make it the length of the modulus).<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1-6">For example for Sub SA ID n, use nth set of keys from the KEYMAT.
The order is specified in Section 2.17 of <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span>.<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
<p id="section-4.2.1-7">With existing prf+ function the keymat length is rather limited.
<span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> limit the iteration to 256.
However, with modern prf+, more specifically XOF, functions,
such as KMAC specified in <span>[<a href="#NIST800-185" class="cite xref">NIST800-185</a>]</span>, or HopMAC/TurboSHAKE
specified <span>[<a href="#I-D.irtf-cfrg-kangarootwelve" class="cite xref">I-D.irtf-cfrg-kangarootwelve</a>]</span> the KEYMAT can be
infinitely,(2^40 bytes), long.<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">An XOF differs from a traditional PRF, hash, function in that it is
designed to generate very long, and variable length output.
Unlike the IKEv2 prf+ an XOF can generate longer outputs directly
without iterative call.<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9">Typical length of of 256 bit encryption is 36 bytes,
(32 + 4 salt for IV), in one direction. Using an AEAD for 64K Sub SAs
maximum KEYMAT length would
be:<a href="#section-4.2.1-9" class="pilcrow">¶</a></p>
<p id="section-4.2.1-10">4718592 bytes = 2^16 * 2 * 36 bytes. i.e. 4.5 Mega Bytes<a href="#section-4.2.1-10" class="pilcrow">¶</a></p>
<p id="section-4.2.1-11">When using non AEAD algorithms KEMAT size would roughly double of the
above, about 9 Mega Bytes.<a href="#section-4.2.1-11" class="pilcrow">¶</a></p>
<p id="section-4.2.1-12">The memory requirment fot generate could be reduced by changing prf+
function interface to return portion of the KEYMAT when using
iterative feedback mode.<a href="#section-4.2.1-12" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.2">
          <h4 id="name-hierarchical-key-derivation">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-hierarchical-key-derivation" class="section-name selfRef">Hierarchical key derivation</a>
          </h4>
<p id="section-4.2.2-1">Hierarchical key derivation use Sub SA ID, which is carried in EESP
Seesion ID or in EESP Flow ID(TLV), as an input to the key dervivation.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">Two KDF are propsed below and eventually choose one of them.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">KEYMAT = prf+(SK_child, Sub SA ID)<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">Where SK_child is the key derived for the Child SA as specified in
<span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span> section 2.17<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2-5">One advantage of Hierarchical KDF is KEYMAT for the Sub SAs can be
generated on the fly, for every packet, when available memory is
limited, for example <span>[<a href="#PSP" class="cite xref">PSP</a>]</span>. This is usually the case when key
derivation is implemented in hardware. When implimenting in hardware
choose a hardware friendly prf+.<a href="#section-4.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2.2-6">An alternative key derivation :<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2.2-7">KEYMAT = prf+(SK_d, Ni | Nr | Flow ID)<a href="#section-4.2.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2.2-8">NOTE: does using using Ni|Nr|g^ir KDF input matters? Is there a
perfernece? Any advise from the cryptographers?<a href="#section-4.2.2-8" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.3">
        <h3 id="name-rekey-key-derivation">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-rekey-key-derivation" class="section-name selfRef">Rekey Key Derivation.</a>
        </h3>
<p id="section-4.3-1">During the EESP SA rekey, new keys are derived using the new Ni
and Nr values. If a Key Exchange (KE) method was used in the rekying,
CREATE_CHILD_SA exchange, the new key MAY also include g^ir as part of
the derivation process.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">KEYMAT = prf+(SK_child, Sub SA ID)<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">or depending on which one of the above KDF is chossen.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">KEYMAT = prf+(SK_d, g^ir (new) | Ni | Nr | Sub SA ID)<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">Even though each Sub SA can be independently rekeyed, for
simplicity and security, all Sub SAs MUST be rekeyed together
when either a cryptographic limit or a time-based limit is
reached.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">The time-based limit, also described in Section 2.8 of
[RFC7296], ensures periodic key replacement to minimize the risks
associated with long-term key exposure, even if the cryptographic
limit has not been reached.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">When rekeying is triggered for any of the Sub SA by whichever
limit—cryptographic or time- based—is reached first, subseqenty all
Sub SAs must rekeyed.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4.4">
        <h3 id="name-multiple-sender-group-sa-da">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-multiple-sender-group-sa-da" class="section-name selfRef">Multiple Sender Group SA Data SA Key Derivation</a>
        </h3>
<p id="section-4.4-1">When using EESP with a group SA, as specified in
<span>[<a href="#I-D.ietf-ipsecme-g-ikev2" class="cite xref">I-D.ietf-ipsecme-g-ikev2</a>]</span>, the Sender-ID MUST be used for
deriving a unique key for each sender. This ensures that each
sender maintains a distinct IV and/or sequence number space.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The Sender-ID is carried in each packet within the Session ID
field, allowing efficient and reliable key differentiation for
data security and integrity.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-5">
      <h2 id="name-session-id">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-session-id" class="section-name selfRef">Session ID</a>
      </h2>
<p id="section-5-1">The Session ID is a multi-purpose attribute with mutually
exclusive values. The initiator MUST propose a single value in the
Child SA proposal, Transform EESPSSID (Value). The responder MUST
either accept the proposed value or reject it with an
INVALID_SESSION_ID error message, indicating a supported value.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-udp-encapsulation-for-eesp">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-udp-encapsulation-for-eesp" class="section-name selfRef">UDP Encapsulation for EESP</a>
      </h2>
<p id="section-6-1">UDP encapsulation for EESP is largely similar to the ESP UDP
encapsulation specified in <span>[<a href="#RFC3948" class="cite xref">RFC3948</a>]</span>, with the primary difference
being the UDP ports used by the EESP Security Association (SA) and
hence the IKE SA that negotiated the EESP SA. This distinction allows
for more flexible handling of EESP traffic, particularly ECMP support
along the path and in the NIC. This also allows supporting EESP and
ESP on the same IPsec gateway, however with different IKE sesssions.<a href="#section-6-1" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-responder-receiving-port">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-responder-receiving-port" class="section-name selfRef">Responder Receiving Port</a>
        </h3>
<p id="section-6.1-1">During an IKE_INIT exchange, the responder MAY send an
EESP_IN_UDP_SUPPORT(port) notification containing the receiver port
number. This mechanism enables the responder to designate a unique
port for EESP, distinct from the port used for ESP for UDP
encapsulation. The intent is to utilize a single, preferred EESP
receiver port for all EESP peers.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="sourcecode" id="section-6.1-2">
<pre>
#+caption: EESP_IN_UDP_SUPPORT Notfier
#+name: EESP_IN_UDP_SUPPORT
         1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-------------------------------+-------------------------------+
| Next Payload  |C|  RESERVED   |         Payload Length        |
+---------------+---------------+-------------------------------+
|  Protocol ID  |   SPI Size    |      Notify Message Type      |
+---------------+---------------+-------------------------------+
| UDP Destination Port          |                               |
+-------------------------------+-------------------------------+
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">(C)ritical flag - MUST be 0<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.2">
            <p id="section-6.1-3.2.1">Protocol ID (1 octet) - MUST be 0. MUST be ignored if not 0.<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.3">
            <p id="section-6.1-3.3.1">SPI Size (1 octet) - MUST be 0. MUST be ignored if not 0.<a href="#section-6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.4">
            <p id="section-6.1-3.4.1">Notify Status Message Type value (2 octets) - set to [TBD9]<a href="#section-6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.1-3.5">
            <p id="section-6.1-3.5.1">UDP Destination Port - MUST be non zero (two octets).<a href="#section-6.1-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.1-4">The initiator MAY select its source port—the port where it will
receive UDP packets—during either the IKE_INIT or IKE_AUTH exchange.
The source port used in the IKE_AUTH exchange SHALL become the source
port for the EESP SA.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">An implementation detail: When a peer uses unique ports for ESP and
EESP, the designated port MUST only receive further IKE messages
specific to the corresponding SA type. For example, if port 4500
is assigned to ESP and port 4501 to EESP, port 4500 MUST only
receive ESP SA-related IKE messages, while port 4501 MUST only
receive EESP SA-related messages. This approach simplifies NAT
mappings for the peer.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">A unique destination port is necessary to support ESP and EESP SA
on the same receiver with mapping changes. This ensures that packets
are correctly matched to their respective SAs, avoiding ambiguity
when there is a NAT mapping change, particularly with stateless NAT
gateways. However, if mapping changes are not supported, ESP and EESP
may share the same UDP destination port. Mapping changes are necessary
when there are NAT gateways, specifically a one-to-many stateless NAT
gateway. When mapping changes are not required, the receiver may use
the UDP 4-tuple to look up a peer. A pair of peers can only use either
ESP or EESP. It is strongly recommended to allocate unique SPIs for
ESP and EESP on the receiver. This approach provides robust traffic
classification, minimizes the risk of misinterpretation,
enhances overall system mangability, and makes it easier for
administrators to follow SAs.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">A stateless receiver can only support either ESP or EESP on a UDP
port.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-7">
      <h2 id="name-eesp-crypt-offset-option">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-eesp-crypt-offset-option" class="section-name selfRef">EESP Crypt Offset Option</a>
      </h2>
<p id="section-7-1">This option is typically used for within one Datacenter use case
such as <span>[<a href="#PSP" class="cite xref">PSP</a>]</span>. To negotiate, the initiator sends USE_CRYPTOFFSET
together with USE_TRANSPORT_MODE and the responder respond with the
same. USE_EESP_CRYPTOFFSET is not supported in Tunnel mode or BEET
mode.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">'<code>NOTE</code>' Add EESP draft section reference.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-changes-in-the-existing-ike">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-changes-in-the-existing-ike" class="section-name selfRef">Changes in the Existing IKEv2 Registries</a>
        </h3>
<section id="section-8.1.1">
          <h4 id="name-ikev2-security-protocol-ide">
<a href="#section-8.1.1" class="section-number selfRef">8.1.1. </a><a href="#name-ikev2-security-protocol-ide" class="section-name selfRef">IKEv2 Security Protocol Identifiers registry</a>
          </h4>
<p id="section-8.1.1-1">This document defines new Protocol ID in the
"IKEv2 Security Protocol Identifiers" registry, <span>[<a href="#IKEv2-SP" class="cite xref">IKEv2-SP</a>]</span>:<a href="#section-8.1.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Protocol ID</th>
                <th class="text-left" rowspan="1" colspan="1">Protocol</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">[TBD1]</td>
                <td class="text-left" rowspan="1" colspan="1">EESP</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
            </tbody>
          </table>
</section>
<section id="section-8.1.2">
          <h4 id="name-ikev2-transform-type-values">
<a href="#section-8.1.2" class="section-number selfRef">8.1.2. </a><a href="#name-ikev2-transform-type-values" class="section-name selfRef">IKEv2 Transform Type Values registry</a>
          </h4>
<p id="section-8.1.2-1">This document defines new transforms in
"IKEv2 Transform Type Values" registry, <span>[<a href="#IKEv2-Transforms" class="cite xref">IKEv2-Transforms</a>]</span><a href="#section-8.1.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Type</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
                <th class="text-left" rowspan="1" colspan="1">Used In</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TBD4</td>
                <td class="text-left" rowspan="1" colspan="1">EESP Version(EESPV)</td>
                <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TBD5</td>
                <td class="text-left" rowspan="1" colspan="1">EESP Sub SA(EESPSUBSA)</td>
                <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TBD6</td>
                <td class="text-left" rowspan="1" colspan="1">EESP Session ID(EESPSID)</td>
                <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TBD7</td>
                <td class="text-left" rowspan="1" colspan="1">EESP Flow ID(EESPFID)</td>
                <td class="text-left" rowspan="1" colspan="1">(EESP)</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
            </tbody>
          </table>
</section>
<section id="section-8.1.3">
          <h4 id="name-ikev2-notify-message-status">
<a href="#section-8.1.3" class="section-number selfRef">8.1.3. </a><a href="#name-ikev2-notify-message-status" class="section-name selfRef">IKEv2 Notify Message Status Types registry.</a>
          </h4>
<table class="center" id="table-4">
            <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-left" rowspan="1" colspan="1">Notify Message Status Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TBD8</td>
                <td class="text-left" rowspan="1" colspan="1">USE_EESP_CRYPTOFFSET</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TBD9</td>
                <td class="text-left" rowspan="1" colspan="1">EESP_IN_UDP_SUPPORT</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
            </tbody>
          </table>
</section>
<section id="section-8.1.4">
          <h4 id="name-extending-esp-with-eesp">
<a href="#section-8.1.4" class="section-number selfRef">8.1.4. </a><a href="#name-extending-esp-with-eesp" class="section-name selfRef">Extending ESP with EESP</a>
          </h4>
<p id="section-8.1.4-1">Several tables in <span>[<a href="#IKEv2-IANA" class="cite xref">IKEv2-IANA</a>]</span> that specify ESP as protocol
should be extended with EESP. Should we list each table one by one or
specify as replace ESP, with ESP, EESP.e.g in the Transform Type Values,
replace 'IKE and ESP' with 'IKE, ESP, and EESP'<a href="#section-8.1.4-1" class="pilcrow">¶</a></p>
<p id="section-8.1.4-2">Changes the "Used In" column for the existing allocations as follows;<a href="#section-8.1.4-2" class="pilcrow">¶</a></p>
</section>
<section id="section-8.1.5">
          <h4 id="name-notify-message-error-types">
<a href="#section-8.1.5" class="section-number selfRef">8.1.5. </a><a href="#name-notify-message-error-types" class="section-name selfRef">Notify Message Error Types</a>
          </h4>
<p id="section-8.1.5-1">This document defines new Notify Message types in the
"IKEv2 Notify Message Error Types" registry:<a href="#section-8.1.5-1" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
            <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
                <th class="text-left" rowspan="1" colspan="1">Notify Message Error Type</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">[TBD2]</td>
                <td class="text-left" rowspan="1" colspan="1">INVALID_SESSION_ID</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">[TBD3]</td>
                <td class="text-left" rowspan="1" colspan="1">INVALID_SUB_SA</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
            </tbody>
          </table>
</section>
</section>
<section id="section-8.2">
        <h3 id="name-new-registries">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-new-registries" class="section-name selfRef">New Registries</a>
        </h3>
<p id="section-8.2-1">A new set of registries is created for EESP-IKEv2 on IKEv2 parameters
page <span>[<a href="#IKEv2-IANA" class="cite xref">IKEv2-IANA</a>]</span>. The terms Reserved, Expert Review and Private
Use are to be applied as defined in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span><a href="#section-8.2-1" class="pilcrow">¶</a></p>
<section id="section-8.2.1">
          <h4 id="name-eesp-session-id-registry">
<a href="#section-8.2.1" class="section-number selfRef">8.2.1. </a><a href="#name-eesp-session-id-registry" class="section-name selfRef">EESP Session ID registry</a>
          </h4>
<p id="section-8.2.1-1">IANA is requested to create a new registry named
'EESP Session ID Transform' in the 'Internet Key Exchange Version 2
(IKEv2) Parameters', <span>[<a href="#IKEv2-IANA" class="cite xref">IKEv2-IANA</a>]</span> page.<a href="#section-8.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.1-2.1">
              <p id="section-8.2.1-2.1.1">Name: EESP Session ID Transform Registry<a href="#section-8.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-2.2">
              <p id="section-8.2.1-2.2.1">Description: EESP Base Header Session ID<a href="#section-8.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.1-2.3">
              <p id="section-8.2.1-2.3.1">Reference: This document<a href="#section-8.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<table class="center" id="table-6">
            <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Session ID</th>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Unspecified</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">ENCRYPION_ID</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">SUB_SA_ID</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
            </tbody>
          </table>
</section>
<section id="section-8.2.2">
          <h4 id="name-eesp-flow-id-registry">
<a href="#section-8.2.2" class="section-number selfRef">8.2.2. </a><a href="#name-eesp-flow-id-registry" class="section-name selfRef">EESP Flow ID registry</a>
          </h4>
<p id="section-8.2.2-1">IANA is requested to create a new registry named
'EESP Session Flow ID Transform' in the
'Internet Key Exchange Version 2
(IKEv2) Parameters', <span>[<a href="#IKEv2-IANA" class="cite xref">IKEv2-IANA</a>]</span> page.<a href="#section-8.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.2.2-2.1">
              <p id="section-8.2.2-2.1.1">Name: EESP Flow ID Transform Registry<a href="#section-8.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-2.2">
              <p id="section-8.2.2-2.2.1">Description: EESP Flow Identifier<a href="#section-8.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-8.2.2-2.3">
              <p id="section-8.2.2-2.3.1">Reference: This document<a href="#section-8.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<table class="center" id="table-7">
            <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">Flow ID</th>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Unspecified</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">VNI32</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">VNI64</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">SUB_SA_16</td>
                <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              </tr>
            </tbody>
          </table>
</section>
</section>
</section>
<section id="section-9">
      <h2 id="name-implementation-status">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-9-1">[Note to RFC Editor: Please remove this section and the reference to
<span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span> before publication.]<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">This section records the status of known implementations of the
protocol defined by this specification at the time of posting of this
Internet-Draft, and is based on a proposal described in <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>.
The description of implementations in this section is intended to
assist the IETF in its decision processes in progressing drafts to
RFCs. Please note that the listing of any individual implementation
here does not imply endorsement by the IETF. Furthermore, no effort
has been spent to verify the information presented here that was
supplied by IETF contributors. This is not intended as, and must not
be construed to be, a catalog of available implementations or their
features. Readers are advised to note that other implementations may
exist.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working
groups to assign due consideration to documents that have the benefit
of running code, which may serve as evidence of valuable
experimentation and feedback that have made the implemented protocols
more mature. It is up to the individual working groups to use this
information as they see fit".<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Authors are requested to add a note to the RFC Editor at the top of
this section, advising the Editor to remove the entire section before
publication, as well as the reference to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>.<a href="#section-9-4" class="pilcrow">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">EESP option Crypt Offset <span>[<a href="#I-D.klassert-ipsecme-eesp" class="cite xref">I-D.klassert-ipsecme-eesp</a>]</span> section [XXX]
allows exposing transport headers for telemetry.
It is indented use of within data center.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">When an EESP receiver implementation uses Stateless Decryption, it
may not rely on single Security Policy Database (SPD) as specified in
the IPsec Architecture document <span>[<a href="#RFC4301" class="cite xref">RFC4301</a>]</span>, section 4.4.1. However,
the receiver MUST validate the negotiated Security Policy through
other means to ensure compliance with the intended security
requirements. For by adding Security Policy to the socket or route
entry. Also comply with ICMP  processing specified  in section 6 of
RFC4301.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Additional security relevant aspects of using the IPsec protocol are
discussed in the Security Architecture document <span>[<a href="#RFC4301" class="cite xref">RFC4301</a>]</span><a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
<section id="section-11">
      <h2 id="name-acknowledgments">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-11-1">TBD<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-normative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-ipsecme-ikev2-rename-esn">[I-D.ietf-ipsecme-ikev2-rename-esn]</dt>
      <dd>
<span class="refAuthor">Smyslov, V.</span>, <span class="refTitle">"Renaming Extended Sequence Number (ESN) Transform Type in the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ipsecme-ikev2-rename-esn-02</span>, <time datetime="2024-12-28" class="refDate">28 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ipsecme-ikev2-rename-esn-02">https://datatracker.ietf.org/doc/html/draft-ietf-ipsecme-ikev2-rename-esn-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.klassert-ipsecme-eesp">[I-D.klassert-ipsecme-eesp]</dt>
      <dd>
<span class="refAuthor">Klassert, S.</span>, <span class="refAuthor">Antony, A.</span>, and <span class="refAuthor">C. Hopps</span>, <span class="refTitle">"Enhanced Encapsulating Security Payload (EESP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-klassert-ipsecme-eesp-01</span>, <time datetime="2024-10-14" class="refDate">14 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-klassert-ipsecme-eesp-01">https://datatracker.ietf.org/doc/html/draft-klassert-ipsecme-eesp-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3948">[RFC3948]</dt>
      <dd>
<span class="refAuthor">Huttunen, A.</span>, <span class="refAuthor">Swander, B.</span>, <span class="refAuthor">Volpe, V.</span>, <span class="refAuthor">DiBurro, L.</span>, and <span class="refAuthor">M. Stenberg</span>, <span class="refTitle">"UDP Encapsulation of IPsec ESP Packets"</span>, <span class="seriesInfo">RFC 3948</span>, <span class="seriesInfo">DOI 10.17487/RFC3948</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3948">https://www.rfc-editor.org/info/rfc3948</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4301">[RFC4301]</dt>
      <dd>
<span class="refAuthor">Kent, S.</span> and <span class="refAuthor">K. Seo</span>, <span class="refTitle">"Security Architecture for the Internet Protocol"</span>, <span class="seriesInfo">RFC 4301</span>, <span class="seriesInfo">DOI 10.17487/RFC4301</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4301">https://www.rfc-editor.org/info/rfc4301</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4303">[RFC4303]</dt>
      <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4303">https://www.rfc-editor.org/info/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5840">[RFC5840]</dt>
      <dd>
<span class="refAuthor">Grewal, K.</span>, <span class="refAuthor">Montenegro, G.</span>, and <span class="refAuthor">M. Bhatia</span>, <span class="refTitle">"Wrapped Encapsulating Security Payload (ESP) for Traffic Visibility"</span>, <span class="seriesInfo">RFC 5840</span>, <span class="seriesInfo">DOI 10.17487/RFC5840</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5840">https://www.rfc-editor.org/info/rfc5840</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
      <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
      <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-13">
      <h2 id="name-informative-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-ipsecme-g-ikev2">[I-D.ietf-ipsecme-g-ikev2]</dt>
      <dd>
<span class="refAuthor">Smyslov, V.</span> and <span class="refAuthor">B. Weis</span>, <span class="refTitle">"Group Key Management using IKEv2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ipsecme-g-ikev2-19</span>, <time datetime="2024-12-28" class="refDate">28 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-ipsecme-g-ikev2-19">https://datatracker.ietf.org/doc/html/draft-ietf-ipsecme-g-ikev2-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-kangarootwelve">[I-D.irtf-cfrg-kangarootwelve]</dt>
      <dd>
<span class="refAuthor">Viguier, B.</span>, <span class="refAuthor">Wong, D.</span>, <span class="refAuthor">Van Assche, G.</span>, <span class="refAuthor">Dang, Q.</span>, and <span class="refAuthor">J. Daemen</span>, <span class="refTitle">"KangarooTwelve and TurboSHAKE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-kangarootwelve-16</span>, <time datetime="2024-12-21" class="refDate">21 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-kangarootwelve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-kangarootwelve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.mrossberg-ipsecme-multiple-sequence-counters">[I-D.mrossberg-ipsecme-multiple-sequence-counters]</dt>
      <dd>
<span class="refAuthor">Rossberg, M.</span>, <span class="refAuthor">Klassert, S.</span>, and <span class="refAuthor">M. Pfeiffer</span>, <span class="refTitle">"Broadening the Scope of Encapsulating Security Payload (ESP) Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-mrossberg-ipsecme-multiple-sequence-counters-02</span>, <time datetime="2024-02-15" class="refDate">15 February 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-mrossberg-ipsecme-multiple-sequence-counters-02">https://datatracker.ietf.org/doc/html/draft-mrossberg-ipsecme-multiple-sequence-counters-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ponchon-ipsecme-anti-replay-subspaces">[I-D.ponchon-ipsecme-anti-replay-subspaces]</dt>
      <dd>
<span class="refAuthor">Ponchon, P.</span>, <span class="refAuthor">Shaikh, M.</span>, <span class="refAuthor">Dernaika, H.</span>, <span class="refAuthor">Pfister, P.</span>, and <span class="refAuthor">G. Solignac</span>, <span class="refTitle">"IPsec and IKE anti-replay sequence number subspaces for traffic-engineered paths and multi-core processing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ponchon-ipsecme-anti-replay-subspaces-03</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ponchon-ipsecme-anti-replay-subspaces-03">https://datatracker.ietf.org/doc/html/draft-ponchon-ipsecme-anti-replay-subspaces-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKEv2-Enc">[IKEv2-Enc]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IKEv2 Parameters: Extended Sequence Numbers Transform IDs"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-5">https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKEv2-IANA">[IKEv2-IANA]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IKEv2 Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml">https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKEv2-RP">[IKEv2-RP]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IKEv2 Parameters: Encryption Algorithm Transform IDs"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-9">https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-9</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKEv2-SP">[IKEv2-SP]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IKEv2 Parameters: Security Protocol Identifiers"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-18">https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IKEv2-Transforms">[IKEv2-Transforms]</dt>
      <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IKEv2 Parameters: Transform Type Values"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-3">https://www.iana.org/assignments/ikev2-parameters/ikev2-parameters.xhtml#ikev2-parameters-3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST800-185">[NIST800-185]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"SHA-3 Derived Functions: cSHAKE, KMAC, TupleHash and ParallelHash"</span>, <span>&lt;<a href="https://csrc.nist.gov/pubs/sp/800/185/final">https://csrc.nist.gov/pubs/sp/800/185/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PSP">[PSP]</dt>
      <dd>
<span class="refAuthor">Google</span>, <span class="refTitle">"PSP Architecture Specification"</span>, <span>&lt;<a href="https://github.com/google/psp/blob/main/doc/PSP_Arch_Spec.pdf">https://github.com/google/psp/blob/main/doc/PSP_Arch_Spec.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2992">[RFC2992]</dt>
      <dd>
<span class="refAuthor">Hopps, C.</span>, <span class="refTitle">"Analysis of an Equal-Cost Multi-Path Algorithm"</span>, <span class="seriesInfo">RFC 2992</span>, <span class="seriesInfo">DOI 10.17487/RFC2992</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2992">https://www.rfc-editor.org/info/rfc2992</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3947">[RFC3947]</dt>
      <dd>
<span class="refAuthor">Kivinen, T.</span>, <span class="refAuthor">Swander, B.</span>, <span class="refAuthor">Huttunen, A.</span>, and <span class="refAuthor">V. Volpe</span>, <span class="refTitle">"Negotiation of NAT-Traversal in the IKE"</span>, <span class="seriesInfo">RFC 3947</span>, <span class="seriesInfo">DOI 10.17487/RFC3947</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3947">https://www.rfc-editor.org/info/rfc3947</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4555">[RFC4555]</dt>
      <dd>
<span class="refAuthor">Eronen, P.</span>, <span class="refTitle">"IKEv2 Mobility and Multihoming Protocol (MOBIKE)"</span>, <span class="seriesInfo">RFC 4555</span>, <span class="seriesInfo">DOI 10.17487/RFC4555</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4555">https://www.rfc-editor.org/info/rfc4555</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
      <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7942">https://www.rfc-editor.org/info/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8750">[RFC8750]</dt>
      <dd>
<span class="refAuthor">Migault, D.</span>, <span class="refAuthor">Guggemos, T.</span>, and <span class="refAuthor">Y. Nir</span>, <span class="refTitle">"Implicit Initialization Vector (IV) for Counter-Based Ciphers in Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 8750</span>, <span class="seriesInfo">DOI 10.17487/RFC8750</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8750">https://www.rfc-editor.org/info/rfc8750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9347">[RFC9347]</dt>
      <dd>
<span class="refAuthor">Hopps, C.</span>, <span class="refTitle">"Aggregation and Fragmentation Mode for Encapsulating Security Payload (ESP) and Its Use for IP Traffic Flow Security (IP-TFS)"</span>, <span class="seriesInfo">RFC 9347</span>, <span class="seriesInfo">DOI 10.17487/RFC9347</span>, <time datetime="2023-01" class="refDate">January 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9347">https://www.rfc-editor.org/info/rfc9347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9611">[RFC9611]</dt>
    <dd>
<span class="refAuthor">Antony, A.</span>, <span class="refAuthor">Brunner, T.</span>, <span class="refAuthor">Klassert, S.</span>, and <span class="refAuthor">P. Wouters</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2) Support for Per-Resource Child Security Associations (SAs)"</span>, <span class="seriesInfo">RFC 9611</span>, <span class="seriesInfo">DOI 10.17487/RFC9611</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9611">https://www.rfc-editor.org/info/rfc9611</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="appendix-A">
      <h2 id="name-additional-stuff">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-additional-stuff" class="section-name selfRef">Additional Stuff</a>
      </h2>
<p id="appendix-A-1">TBD<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steffen Klassert</span></div>
<div dir="auto" class="left"><span class="org">secunet Security Networks AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:steffen.klassert@secunet.com" class="email">steffen.klassert@secunet.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Antony Antony</span></div>
<div dir="auto" class="left"><span class="org">secunet Security Networks AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:antony.antony@secunet.com" class="email">antony.antony@secunet.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Brunner</span></div>
<div dir="auto" class="left"><span class="org">codelabs GmbH</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias@codelabs.ch" class="email">tobias@codelabs.ch</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
